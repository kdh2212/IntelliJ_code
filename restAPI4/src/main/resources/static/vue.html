<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>사용자 관리 시스템 (Vue.js)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="app" class="container mt-5">
        <h2>사용자 관리 시스템 (Vue.js)</h2>
        
        <form @submit.prevent="saveUser" class="mb-4">
            <input type="hidden" v-model="user.id">
            <div class="mb-3">
                <label for="name" class="form-label">이름</label>
                <input type="text" class="form-control" id="name" v-model="user.name" required>
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">이메일</label>
                <input type="email" class="form-control" id="email" v-model="user.email" required>
            </div>
            <div class="mb-3">
                <label for="age" class="form-label">나이</label>
                <input type="number" class="form-control" id="age" v-model="user.age" required>
            </div>
            <button type="submit" class="btn btn-primary">저장</button>
            <button type="button" class="btn btn-secondary" @click="resetForm">취소</button>
        </form>

        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>이름</th>
                    <th>이메일</th>
                    <th>나이</th>
                    <th>작업</th>
                </tr>
            </thead>
            <tbody>
                <tr v-if="users.length === 0">
                    <td colspan="5" class="text-center">데이터가 없습니다.</td>
                </tr>
                <tr v-for="user in users" :key="user.id">
                    <td>{{ user.id }}</td>
                    <td>{{ user.name }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.age }}</td>
                    <td>
                        <button class="btn btn-sm btn-warning me-1" @click="editUser(user)">수정</button>
                        <button class="btn btn-sm btn-danger" @click="deleteUser(user.id)">삭제</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        const { createApp } = Vue

        createApp({
            data() {
                return {
                    users: [],
                    user: {
                        id: null,
                        name: '',
                        email: '',
                        age: null
                    }
                }
            },
            methods: {
                async loadUsers() {
                    try {
                        const response = await axios.get('/api/users')
                        this.users = response.data
                    } catch (error) {
                        alert('데이터 로딩 중 오류가 발생했습니다: ' + error.message)
                    }
                },
                async saveUser() {
                    try {
                        if (this.user.id) {
                            await axios.put(`/api/users/${this.user.id}`, {
                                ...this.user,
                                age: parseInt(this.user.age)
                            })
                        } else {
                            await axios.post('/api/users', {
                                ...this.user,
                                age: parseInt(this.user.age)
                            })
                        }
                        this.loadUsers()
                        this.resetForm()
                    } catch (error) {
                        alert('저장 중 오류가 발생했습니다: ' + error.message)
                    }
                },
                async deleteUser(id) {
                    if (confirm('정말 삭제하시겠습니까?')) {
                        try {
                            await axios.delete(`/api/users/${id}`)
                            this.loadUsers()
                        } catch (error) {
                            alert('삭제 중 오류가 발생했습니다: ' + error.message)
                        }
                    }
                },
                editUser(user) {
                    this.user = { ...user }
                },
                resetForm() {
                    this.user = {
                        id: null,
                        name: '',
                        email: '',
                        age: null
                    }
                }
            },
            mounted() {
                this.loadUsers()
            }
        }).mount('#app')
    </script>
</body>
</html> 