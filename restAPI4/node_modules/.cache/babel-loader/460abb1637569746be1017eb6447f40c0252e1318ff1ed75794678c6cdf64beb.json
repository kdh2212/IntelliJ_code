{"ast":null,"code":"import _objectSpread from \"C:/_dev3/restAPI4/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/web.timers.js\";\n// Utilities\nimport { computed, nextTick, onScopeDispose, reactive, resolveDynamicComponent, toRef } from 'vue';\nimport { deepEqual, getCurrentInstance, hasEvent, IN_BROWSER, propsFactory } from \"../util/index.mjs\"; // Types\nexport function useRoute() {\n  var vm = getCurrentInstance('useRoute');\n  return computed(function () {\n    var _vm$proxy;\n    return vm === null || vm === void 0 || (_vm$proxy = vm.proxy) === null || _vm$proxy === void 0 ? void 0 : _vm$proxy.$route;\n  });\n}\nexport function useRouter() {\n  var _getCurrentInstance;\n  return (_getCurrentInstance = getCurrentInstance('useRouter')) === null || _getCurrentInstance === void 0 || (_getCurrentInstance = _getCurrentInstance.proxy) === null || _getCurrentInstance === void 0 ? void 0 : _getCurrentInstance.$router;\n}\nexport function useLink(props, attrs) {\n  var _link$value2, _link$value3;\n  var RouterLink = resolveDynamicComponent('RouterLink');\n  var isLink = computed(function () {\n    return !!(props.href || props.to);\n  });\n  var isClickable = computed(function () {\n    return (isLink === null || isLink === void 0 ? void 0 : isLink.value) || hasEvent(attrs, 'click') || hasEvent(props, 'click');\n  });\n  if (typeof RouterLink === 'string' || !('useLink' in RouterLink)) {\n    var _href = toRef(props, 'href');\n    return {\n      isLink: isLink,\n      isClickable: isClickable,\n      href: _href,\n      linkProps: reactive({\n        href: _href\n      })\n    };\n  }\n  // vue-router useLink `to` prop needs to be reactive and useLink will crash if undefined\n  var linkProps = computed(function () {\n    return _objectSpread(_objectSpread({}, props), {}, {\n      to: toRef(function () {\n        return props.to || '';\n      })\n    });\n  });\n  var routerLink = RouterLink.useLink(linkProps.value);\n  // Actual link needs to be undefined when to prop is not used\n  var link = computed(function () {\n    return props.to ? routerLink : undefined;\n  });\n  var route = useRoute();\n  var isActive = computed(function () {\n    var _link$value$isActive$, _link$value$isActive, _link$value$isExactAc, _link$value$isExactAc2, _link$value$isExactAc3;\n    if (!link.value) return false;\n    if (!props.exact) return (_link$value$isActive$ = (_link$value$isActive = link.value.isActive) === null || _link$value$isActive === void 0 ? void 0 : _link$value$isActive.value) !== null && _link$value$isActive$ !== void 0 ? _link$value$isActive$ : false;\n    if (!route.value) return (_link$value$isExactAc = (_link$value$isExactAc2 = link.value.isExactActive) === null || _link$value$isExactAc2 === void 0 ? void 0 : _link$value$isExactAc2.value) !== null && _link$value$isExactAc !== void 0 ? _link$value$isExactAc : false;\n    return ((_link$value$isExactAc3 = link.value.isExactActive) === null || _link$value$isExactAc3 === void 0 ? void 0 : _link$value$isExactAc3.value) && deepEqual(link.value.route.value.query, route.value.query);\n  });\n  var href = computed(function () {\n    var _link$value;\n    return props.to ? (_link$value = link.value) === null || _link$value === void 0 ? void 0 : _link$value.route.value.href : props.href;\n  });\n  return {\n    isLink: isLink,\n    isClickable: isClickable,\n    isActive: isActive,\n    route: (_link$value2 = link.value) === null || _link$value2 === void 0 ? void 0 : _link$value2.route,\n    navigate: (_link$value3 = link.value) === null || _link$value3 === void 0 ? void 0 : _link$value3.navigate,\n    href: href,\n    linkProps: reactive({\n      href: href,\n      'aria-current': computed(function () {\n        return isActive.value ? 'page' : undefined;\n      })\n    })\n  };\n}\nexport var makeRouterProps = propsFactory({\n  href: String,\n  replace: Boolean,\n  to: [String, Object],\n  exact: Boolean\n}, 'router');\nvar inTransition = false;\nexport function useBackButton(router, cb) {\n  var popped = false;\n  var removeBefore;\n  var removeAfter;\n  if (IN_BROWSER && router !== null && router !== void 0 && router.beforeEach) {\n    nextTick(function () {\n      window.addEventListener('popstate', onPopstate);\n      removeBefore = router.beforeEach(function (to, from, next) {\n        if (!inTransition) {\n          setTimeout(function () {\n            return popped ? cb(next) : next();\n          });\n        } else {\n          popped ? cb(next) : next();\n        }\n        inTransition = true;\n      });\n      removeAfter = router === null || router === void 0 ? void 0 : router.afterEach(function () {\n        inTransition = false;\n      });\n    });\n    onScopeDispose(function () {\n      var _removeBefore, _removeAfter;\n      window.removeEventListener('popstate', onPopstate);\n      (_removeBefore = removeBefore) === null || _removeBefore === void 0 || _removeBefore();\n      (_removeAfter = removeAfter) === null || _removeAfter === void 0 || _removeAfter();\n    });\n  }\n  function onPopstate(e) {\n    var _e$state;\n    if ((_e$state = e.state) !== null && _e$state !== void 0 && _e$state.replaced) return;\n    popped = true;\n    setTimeout(function () {\n      return popped = false;\n    });\n  }\n}","map":{"version":3,"names":["computed","nextTick","onScopeDispose","reactive","resolveDynamicComponent","toRef","deepEqual","getCurrentInstance","hasEvent","IN_BROWSER","propsFactory","useRoute","vm","_vm$proxy","proxy","$route","useRouter","_getCurrentInstance","$router","useLink","props","attrs","_link$value2","_link$value3","RouterLink","isLink","href","to","isClickable","value","linkProps","_objectSpread","routerLink","link","undefined","route","isActive","_link$value$isActive$","_link$value$isActive","_link$value$isExactAc","_link$value$isExactAc2","_link$value$isExactAc3","exact","isExactActive","query","_link$value","navigate","makeRouterProps","String","replace","Boolean","Object","inTransition","useBackButton","router","cb","popped","removeBefore","removeAfter","beforeEach","window","addEventListener","onPopstate","from","next","setTimeout","afterEach","_removeBefore","_removeAfter","removeEventListener","e","_e$state","state","replaced"],"sources":["../../src/composables/router.tsx"],"sourcesContent":["// Utilities\nimport {\n  computed,\n  nextTick,\n  onScopeDispose, reactive,\n  resolveDynamicComponent,\n  toRef,\n} from 'vue'\nimport { deepEqual, getCurrentInstance, hasEvent, IN_BROWSER, propsFactory } from '@/util'\n\n// Types\nimport type { ComputedRef, PropType, Ref, SetupContext } from 'vue'\nimport type {\n  RouterLink as _RouterLink,\n  useLink as _useLink,\n  NavigationGuardNext,\n  RouteLocationNormalizedLoaded,\n  RouteLocationRaw,\n  Router,\n  UseLinkOptions,\n} from 'vue-router'\nimport type { EventProp } from '@/util'\n\nexport function useRoute (): Ref<RouteLocationNormalizedLoaded | undefined> {\n  const vm = getCurrentInstance('useRoute')\n\n  return computed(() => vm?.proxy?.$route)\n}\n\nexport function useRouter (): Router | undefined {\n  return getCurrentInstance('useRouter')?.proxy?.$router\n}\n\nexport interface LinkProps {\n  href: string | undefined\n  replace: boolean | undefined\n  to: RouteLocationRaw | undefined\n  exact: boolean | undefined\n}\n\nexport interface LinkListeners {\n  onClick?: EventProp | undefined\n  onClickOnce?: EventProp | undefined\n}\n\nexport interface UseLink extends Omit<Partial<ReturnType<typeof _useLink>>, 'href'> {\n  isLink: ComputedRef<boolean>\n  isClickable: ComputedRef<boolean>\n  href: Ref<string | undefined>\n  linkProps: Record<string, string | undefined>\n}\n\nexport function useLink (props: LinkProps & LinkListeners, attrs: SetupContext['attrs']): UseLink {\n  const RouterLink = resolveDynamicComponent('RouterLink') as typeof _RouterLink | string\n\n  const isLink = computed(() => !!(props.href || props.to))\n  const isClickable = computed(() => {\n    return isLink?.value || hasEvent(attrs, 'click') || hasEvent(props, 'click')\n  })\n\n  if (typeof RouterLink === 'string' || !('useLink' in RouterLink)) {\n    const href = toRef(props, 'href')\n    return {\n      isLink,\n      isClickable,\n      href,\n      linkProps: reactive({ href }),\n    }\n  }\n  // vue-router useLink `to` prop needs to be reactive and useLink will crash if undefined\n  const linkProps = computed(() => ({\n    ...props,\n    to: toRef(() => props.to || ''),\n  }))\n\n  const routerLink = RouterLink.useLink(linkProps.value as UseLinkOptions)\n  // Actual link needs to be undefined when to prop is not used\n  const link = computed(() => props.to ? routerLink : undefined)\n  const route = useRoute()\n  const isActive = computed(() => {\n    if (!link.value) return false\n    if (!props.exact) return link.value.isActive?.value ?? false\n    if (!route.value) return link.value.isExactActive?.value ?? false\n\n    return link.value.isExactActive?.value && deepEqual(link.value.route.value.query, route.value.query)\n  })\n  const href = computed(() => props.to ? link.value?.route.value.href : props.href)\n\n  return {\n    isLink,\n    isClickable,\n    isActive,\n    route: link.value?.route,\n    navigate: link.value?.navigate,\n    href,\n    linkProps: reactive({\n      href,\n      'aria-current': computed(() => isActive.value ? 'page' : undefined),\n    }),\n  }\n}\n\nexport const makeRouterProps = propsFactory({\n  href: String,\n  replace: Boolean,\n  to: [String, Object] as PropType<RouteLocationRaw>,\n  exact: Boolean,\n}, 'router')\n\nlet inTransition = false\nexport function useBackButton (router: Router | undefined, cb: (next: NavigationGuardNext) => void) {\n  let popped = false\n  let removeBefore: (() => void) | undefined\n  let removeAfter: (() => void) | undefined\n\n  if (IN_BROWSER && router?.beforeEach) {\n    nextTick(() => {\n      window.addEventListener('popstate', onPopstate)\n      removeBefore = router.beforeEach((to, from, next) => {\n        if (!inTransition) {\n          setTimeout(() => popped ? cb(next) : next())\n        } else {\n          popped ? cb(next) : next()\n        }\n        inTransition = true\n      })\n      removeAfter = router?.afterEach(() => {\n        inTransition = false\n      })\n    })\n    onScopeDispose(() => {\n      window.removeEventListener('popstate', onPopstate)\n      removeBefore?.()\n      removeAfter?.()\n    })\n  }\n\n  function onPopstate (e: PopStateEvent) {\n    if (e.state?.replaced) return\n\n    popped = true\n    setTimeout(() => (popped = false))\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}